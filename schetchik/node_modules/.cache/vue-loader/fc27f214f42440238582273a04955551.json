{"remainingRequest":"D:\\sites\\simple\\schetchik\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\sites\\simple\\schetchik\\src\\components\\TableBodyCount.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\sites\\simple\\schetchik\\src\\components\\TableBodyCount.vue","mtime":1600439155843},{"path":"D:\\sites\\simple\\schetchik\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\sites\\simple\\schetchik\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\sites\\simple\\schetchik\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\sites\\simple\\schetchik\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0IHsKICAgIG5hbWU6ICdUYWJsZUJvZHlDb3VudCcsCiAgICBwcm9wczogWydtZXRlcnMnLCdpc0FkbWluJywncHJpY2UnXSwKICAgIGRhdGEoKXsKICAgICAgICByZXR1cm4gewoKICAgICAgICB9CiAgICB9LAogICAgY3JlYXRlZDogZnVuY3Rpb24oKSB7CgogICAgfSwKICAgIG1ldGhvZHM6IHsKICAgICAgICBnZXRBbW91bnQoZGF0YSwgb2xkRGF0YSkgewogICAgICAgICAgICBsZXQgYW1vdW50ID0gTWF0aC5yb3VuZCgoZGF0YS5ob3Rfd2F0ZXIgLSBvbGREYXRhLmhvdF93YXRlcikgKiB0aGlzLnByaWNlLndhcm1pbmcgKyAoKGRhdGEuaG90X3dhdGVyIC0gb2xkRGF0YS5ob3Rfd2F0ZXIpICsgKGRhdGEuY29sZF93YXRlciAtIG9sZERhdGEuY29sZF93YXRlcikpICogdGhpcy5wcmljZS53YXRlciArCiAgICAgICAgICAgICAgICAoZGF0YS5lbGVjdHJpYyAtIG9sZERhdGEuZWxlY3RyaWMpICogdGhpcy5wcmljZS5lbGVjdHJpYykgKyAn0YDRg9CxLic7CiAgICAgICAgICAgIHJldHVybiBhbW91bnQ7CiAgICAgICAgfSwKICAgICAgICBjYWxjdWxhdGUoaW5kZXgpIHsKICAgICAgICAgICAgaWYgKGluZGV4ID09PSAwKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGluZGV4ID09PSAnbnVtYmVyJykgewogICAgICAgICAgICAgICAgdGhpcy5jaGVja0lzRW1wdHUoaW5kZXgpOwogICAgICAgICAgICAgICAgdGhpcy5tZXRlcnNbaW5kZXhdLnRvdGFsID0gdGhpcy5nZXRBbW91bnQodGhpcy5tZXRlcnNbaW5kZXhdLCB0aGlzLm1ldGVyc1tpbmRleCAtIDFdKTsKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgZGVsZXRlRGF0ZShpZCkgewogICAgICAgICAgICBpZiAoIXRoaXMuaXNBZG1pbikgewogICAgICAgICAgICAgICAgYWxlcnQoJ9Cj0LTQsNC70Y/RgtGMINC00LDQvdC90YvQtSDQvNC+0LbQtdGCINGC0L7Qu9GM0LrQviDQsNC00LzQuNC90LjRgdGC0YDQsNGC0L7RgCEnKTsKICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgfQogICAgICAgICAgICB0aGlzLiRlbWl0KCdkZWxldGUtZGF0ZScsaWQpOwogICAgICAgIH0sCiAgICAgICAgY2hlY2tJc0VtcHR1KGluZGV4KSB7CiAgICAgICAgICAgIGZvciAobGV0IGkgaW4gdGhpcy5tZXRlcnNbaW5kZXhdKSB7CiAgICAgICAgICAgICAgICBpZiAoaSA9PT0gJ3RvdGFsJykgY29udGludWU7CiAgICAgICAgICAgICAgICBpZiAoIXRoaXMubWV0ZXJzW2luZGV4XVtpXSkgewogICAgICAgICAgICAgICAgICAgIGFsZXJ0KCfQndGD0LbQvdC+INC30LDQv9C+0LvQvdC40YLRjCDQstGB0LUg0L/QvtC70Y8nKTsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIGVkaXRNZXRlcnMoaW5kZXgpIHsKICAgICAgICAgICAgaWYgKCF0aGlzLmlzQWRtaW4pIHsKICAgICAgICAgICAgICAgIGFsZXJ0KCfQoNC10LTQsNC60YLQuNGA0L7QstCw0YLRjCDQtNCw0L3QvdGL0LUg0LzQvtC20LXRgiDRgtC+0LvRjNC60L4g0LDQtNC80LjQvdC40YHRgtGA0LDRgtC+0YAhJyk7CiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdGhpcy5jaGVja0lzRW1wdHUoaW5kZXgpOwogICAgICAgICAgICBsZXQgYWN0aW9uID0gJ2FjdGlvbi1lZGl0X19hZG1pbic7CiAgICAgICAgICAgIHRoaXMuY2FsY3VsYXRlKGluZGV4KTsKICAgICAgICAgICAgbGV0IGRhdGEgPSBuZXcgRm9ybURhdGEoKTsKICAgICAgICAgICAgZm9yIChsZXQga2V5IGluIHRoaXMubWV0ZXJzW2luZGV4XSkgewogICAgICAgICAgICAgICAgZGF0YS5hcHBlbmQoa2V5LCB0aGlzLm1ldGVyc1tpbmRleF1ba2V5XSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZGF0YS5hcHBlbmQoJ2FjdGlvbicsIGFjdGlvbik7CiAgICAgICAgICAgIHRoaXMuJGVtaXQoJ2VkaXQtbWV0ZXJzJyxkYXRhLGluZGV4KTsKICAgICAgICB9LAoKICAgIH0KfTsKCg=="},{"version":3,"sources":["TableBodyCount.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqCA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA","file":"TableBodyCount.vue","sourceRoot":"src/components","sourcesContent":["<template>\n    <tbody class=\"table-count\">\n        <tr v-for=\"(meter, index) in meters\" :key=\"index\" :class=\"[(typeof meter.isUpdate === 'undefined' )?'': meter.isUpdate == 'true'?'update':'']\">\n            <td class=\"p-sm-3\">\n                <input class=\"form__input\" type=\"date\" name=\"date\" data-id=\"\" v-model=\"meter.date\" required>\n            </td>\n            <td class=\"p-sm-3\">\n                <input class=\"form__input\" type=\"number\" name=\"electric\" data-id=\"\" v-model=\"meter.electric\" maxlength=\"30\" required>\n            </td>\n            <td class=\"p-sm-3\">\n                <input class=\"form__input\" type=\"number\" name=\"hot_water\" data-id=\"\" v-model=\"meter.hot_water\" maxl=\"10000000\" required>\n            </td>\n            <td class=\"p-sm-3\">\n                <input class=\"form__input\" type=\"number\" name=\"cold_water\" data-id=\"\" v-model=\"meter.cold_water\" maxl=\"1000000\" required>\n            </td>\n            <td class=\"p-sm-3\">\n                <input class=\"form__input\" type=\"text\" name=\"total\" data-id=\"\" v-model=\"meter.total\" maxl=\"1000000\" required>\n            </td>\n            <td class=\"p-sm-3\">\n                <button title=\"calculator\" class=\"table-action calculator\" name=\"button\" :data-id=\"meter.id\"\n                        @click=\"calculate(index)\">\n                    <i class=\"fa fa-calculator\"></i>\n                </button>\n                <button class=\"form__button table-action edit\" title=\"Edit\" name=\"button_edit\" :data-id=\"meter.id\"\n                        @click=\"editMeters(index)\" type=\"submit\">\n                    <i class=\"fa fa-edit\"></i>\n                </button>\n                <span title=\"Remove\" class=\"table-action remove\" :data-id=\"meter.id\" @click=\"deleteDate(meter.id)\">\n                                    <i class=\"fa fa-remove\"></i>\n                                </span>\n                <span v-if=\"meter.isUpdate\" class=\"update\"><span>&#10004;</span></span>\n            </td>\n        </tr>\n    </tbody>\n</template>\n\n<script>\n    export default {\n        name: 'TableBodyCount',\n        props: ['meters','isAdmin','price'],\n        data(){\n            return {\n\n            }\n        },\n        created: function() {\n\n        },\n        methods: {\n            getAmount(data, oldData) {\n                let amount = Math.round((data.hot_water - oldData.hot_water) * this.price.warming + ((data.hot_water - oldData.hot_water) + (data.cold_water - oldData.cold_water)) * this.price.water +\n                    (data.electric - oldData.electric) * this.price.electric) + 'руб.';\n                return amount;\n            },\n            calculate(index) {\n                if (index === 0) {\n                    return false;\n                } else if (typeof index === 'number') {\n                    this.checkIsEmptu(index);\n                    this.meters[index].total = this.getAmount(this.meters[index], this.meters[index - 1]);\n                }\n            },\n            deleteDate(id) {\n                if (!this.isAdmin) {\n                    alert('Удалять данные может только администратор!');\n                    return false;\n                }\n                this.$emit('delete-date',id);\n            },\n            checkIsEmptu(index) {\n                for (let i in this.meters[index]) {\n                    if (i === 'total') continue;\n                    if (!this.meters[index][i]) {\n                        alert('Нужно заполнить все поля');\n                        return false;\n                    }\n                }\n            },\n            editMeters(index) {\n                if (!this.isAdmin) {\n                    alert('Редактировать данные может только администратор!');\n                    return false;\n                }\n                this.checkIsEmptu(index);\n                let action = 'action-edit__admin';\n                this.calculate(index);\n                let data = new FormData();\n                for (let key in this.meters[index]) {\n                    data.append(key, this.meters[index][key]);\n                }\n                data.append('action', action);\n                this.$emit('edit-meters',data,index);\n            },\n\n        }\n    };\n\n</script>\n\n<style scoped>\n\n</style>"]}]}