(function(t){function e(e){for(var r,n,o=e[0],c=e[1],l=e[2],u=0,m=[];u<o.length;u++)n=o[u],Object.prototype.hasOwnProperty.call(s,n)&&s[n]&&m.push(s[n][0]),s[n]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(t[r]=c[r]);d&&d(e);while(m.length)m.shift()();return i.push.apply(i,l||[]),a()}function a(){for(var t,e=0;e<i.length;e++){for(var a=i[e],r=!0,o=1;o<a.length;o++){var c=a[o];0!==s[c]&&(r=!1)}r&&(i.splice(e--,1),t=n(n.s=a[0]))}return t}var r={},s={app:0},i=[];function n(e){if(r[e])return r[e].exports;var a=r[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=t,n.c=r,n.d=function(t,e,a){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(a,r,function(e){return t[e]}.bind(null,r));return a},n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/schetchik/build/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=e,o=o.slice();for(var l=0;l<o.length;l++)e(o[l]);var d=c;i.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"204c":function(t,e,a){"use strict";var r=a("bd2b"),s=a.n(r);s.a},"314a":function(t,e,a){},"3f94":function(t,e,a){"use strict";var r=a("4717"),s=a.n(r);s.a},"452c":function(t,e,a){},4717:function(t,e,a){},"56d7":function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d");var r=a("a026"),s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("Price",{attrs:{price:t.price}}),a("TableData",{attrs:{isAdmin:t.isAdmin,price:t.price}})],1)},i=[],n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("h2",[t._v("Тариф")]),a("div",{staticClass:"price_water"},[t._v("Расход воды: "),a("b",[t._v(t._s(t.price.water))])]),a("div",{staticClass:"price_warming"},[t._v("Нагрев воды: "),a("b",[t._v(t._s(t.price.warming))])]),a("div",{staticClass:"price_electric"},[t._v("Электричество: "),a("b",[t._v(t._s(t.price.electric))])])])},o=[],c={name:"Price",props:["price"]},l=c,d=a("2877"),u=Object(d["a"])(l,n,o,!1,null,"6359ee70",null),m=u.exports,p=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"fresh-table row justify-content-center"},[a("table",{staticClass:"table",attrs:{id:"fresh-table"}},[t._m(0),a("TableBodyCount",{attrs:{meters:t.meters,isAdmin:t.isAdmin,price:t.price},on:{"delete-date":t.deleteRow,"edit-meters":t.editRow}}),a("tfootAddRow",{attrs:{meters:t.meters,price:t.price},on:{"add-row":t.addRow}})],1)])},f=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",[a("th",{staticClass:"p-sm-3",attrs:{"data-field":"id"}},[t._v("Дата:")]),a("th",{staticClass:"p-sm-3",attrs:{"data-field":"name"}},[t._v("Элек.:")]),a("th",{staticClass:"p-sm-3",attrs:{"data-field":"salary"}},[t._v("Гор. вода:")]),a("th",{staticClass:"p-sm-3",attrs:{"data-field":"country"}},[t._v("Хол. вода:")]),a("th",{staticClass:"p-sm-3",attrs:{"data-field":"city"}},[t._v("Сумма:")]),a("th",{staticClass:"p-sm-3",attrs:{"data-field":"actions"}},[t._v("Actions")])])}],h=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("tbody",{staticClass:"table-count"},t._l(t.meters,(function(e,r){return a("tr",{key:r,class:["undefined"===typeof e.isUpdate?"":"true"==e.isUpdate?"update":""]},[a("td",{staticClass:"p-sm-3"},[a("b-datepicker",{attrs:{name:"date",size:"sm",autocomplete:"on","today-button":"","reset-button":"","close-button":"","date-format-options":{year:"numeric",month:"numeric",day:"numeric"},"start-weekday":1,autofocus:""},model:{value:e.date,callback:function(a){t.$set(e,"date",a)},expression:"meter.date"}})],1),a("td",{staticClass:"p-sm-3"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.electric,expression:"meter.electric"}],staticClass:"form__input",attrs:{type:"number",name:"electric","data-id":"",maxlength:"30",required:""},domProps:{value:e.electric},on:{input:function(a){a.target.composing||t.$set(e,"electric",a.target.value)}}})]),a("td",{staticClass:"p-sm-3"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.hot_water,expression:"meter.hot_water"}],staticClass:"form__input",attrs:{type:"number",name:"hot_water","data-id":"",maxl:"10000000",required:""},domProps:{value:e.hot_water},on:{input:function(a){a.target.composing||t.$set(e,"hot_water",a.target.value)}}})]),a("td",{staticClass:"p-sm-3"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.cold_water,expression:"meter.cold_water"}],staticClass:"form__input",attrs:{type:"number",name:"cold_water","data-id":"",maxl:"1000000",required:""},domProps:{value:e.cold_water},on:{input:function(a){a.target.composing||t.$set(e,"cold_water",a.target.value)}}})]),a("td",{staticClass:"p-sm-3"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.total,expression:"meter.total"}],staticClass:"form__input",attrs:{type:"text",name:"total","data-id":"",maxl:"1000000",required:""},domProps:{value:e.total},on:{input:function(a){a.target.composing||t.$set(e,"total",a.target.value)}}})]),a("td",{staticClass:"p-sm-3"},[a("button",{staticClass:"table-action calculator",attrs:{title:"calculator",name:"button","data-id":e.id},on:{click:function(e){return t.calculate(r)}}},[a("i",{staticClass:"fa fa-calculator"})]),a("button",{staticClass:"form__button table-action edit",attrs:{title:"Edit",name:"button_edit","data-id":e.id,type:"submit"},on:{click:function(e){return t.editMeters(r)}}},[a("i",{staticClass:"fa fa-edit"})]),a("span",{staticClass:"table-action remove",attrs:{title:"Remove","data-id":e.id},on:{click:function(a){return t.deleteDate(e.id)}}},[a("i",{staticClass:"fa fa-remove"})]),e.isUpdate?a("span",{staticClass:"update"},[a("span",[t._v("✔")])]):t._e()])])})),0)},_=[],v={name:"TableBodyCount",props:["meters","isAdmin","price"],data:function(){return{}},created:function(){},methods:{getAmount:function(t,e){var a=Math.round((t.hot_water-e.hot_water)*this.price.warming+(t.hot_water-e.hot_water+(t.cold_water-e.cold_water))*this.price.water+(t.electric-e.electric)*this.price.electric)+"руб.";return a},calculate:function(t){if(0===t)return!1;"number"===typeof t&&(this.checkIsEmptu(t),this.meters[t].total=this.getAmount(this.meters[t],this.meters[t-1]))},deleteDate:function(t){if(!this.isAdmin)return alert("Удалять данные может только администратор!"),!1;this.$emit("delete-date",t)},checkIsEmptu:function(t){for(var e in this.meters[t])if("total"!==e&&!this.meters[t][e])return alert("Нужно заполнить все поля"),!1},editMeters:function(t){if(!this.isAdmin)return alert("Редактировать данные может только администратор!"),!1;this.checkIsEmptu(t);var e="action-edit__admin";this.calculate(t);var a=new FormData;for(var r in this.meters[t])a.append(r,this.meters[t][r]);a.append("action",e),this.$emit("edit-meters",a,t)}}},w=v,b=(a("3f94"),Object(d["a"])(w,h,_,!1,null,null,null)),g=b.exports,C=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("tfoot",[a("tr",[a("td",{staticClass:"p-sm-3"},[a("b-datepicker",{attrs:{placeholder:"Выберите дату",size:"sm","today-button":"","reset-button":"","close-button":"","date-format-options":{year:"numeric",month:"numeric",day:"numeric"},"start-weekday":1,autofocus:""},model:{value:t.addMeters.date,callback:function(e){t.$set(t.addMeters,"date",e)},expression:"addMeters.date"}})],1),a("td",{staticClass:"p-sm-3"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.addMeters.electric,expression:"addMeters.electric"}],staticClass:"form__input form__input-electric",attrs:{type:"number",name:"electric",maxlength:"30",required:""},domProps:{value:t.addMeters.electric},on:{input:function(e){e.target.composing||t.$set(t.addMeters,"electric",e.target.value)}}})]),a("td",{staticClass:"p-sm-3"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.addMeters.hot_water,expression:"addMeters.hot_water"}],staticClass:"form__input form__input-hot_water",attrs:{type:"number",name:"hot_water",maxl:"10000000",required:""},domProps:{value:t.addMeters.hot_water},on:{input:function(e){e.target.composing||t.$set(t.addMeters,"hot_water",e.target.value)}}})]),a("td",{staticClass:"p-sm-3"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.addMeters.cold_water,expression:"addMeters.cold_water"}],staticClass:"form__input form__input-cold_water",attrs:{type:"number",name:"cold_water",maxl:"1000000",required:""},domProps:{value:t.addMeters.cold_water},on:{input:function(e){e.target.composing||t.$set(t.addMeters,"cold_water",e.target.value)}}})]),a("td",{staticClass:"p-sm-3"},[a("span",{staticClass:"total"},[t._v(t._s(t.addMeters.total))])]),a("td",{staticClass:"p-sm-3"},[a("button",{on:{click:t.calculate}},[a("i",{staticClass:"fa fa-calculator"})]),a("button",{staticClass:"form__button_add",attrs:{name:"button_add",type:"submit"},on:{click:t.setMeters}},[a("i",{staticClass:"fa fa-cloud-upload"})])])])])},y=[],x={name:"tfootAddRow",props:["meters","price"],data:function(){return{addMeters:{action:"add",date:"",electric:"",hot_water:"",cold_water:"",total:""}}},created:function(){this.addMeters.date=new Date},watch:{meters:function(){this.addMeters={action:"add",date:"",electric:"",hot_water:"",cold_water:"",total:""}}},methods:{setMeters:function(){if(this.addMeters.total||this.calculate(),this.addMeters.total){var t=new FormData;for(var e in this.addMeters)t.append(e,this.addMeters[e]);this.$emit("add-row",t)}},getAmount:function(t,e){var a=Math.round((t.hot_water-e.hot_water)*this.price.warming+(t.hot_water-e.hot_water+(t.cold_water-e.cold_water))*this.price.water+(t.electric-e.electric)*this.price.electric)+"руб.";return a},calculate:function(){for(var t in this.addMeters)if("total"!==t&&!this.addMeters[t])return alert("Нужно заполнить все поля"),!1;this.addMeters.total=this.getAmount(this.addMeters,this.meters[this.meters.length-1])}}},M=x,A=(a("df99"),Object(d["a"])(M,C,y,!1,null,null,null)),k=A.exports,$={name:"TableData",components:{TableBodyCount:g,tfootAddRow:k},props:["isAdmin","price"],data:function(){return{meters:[{}],url:{meters:"http://lobochkin.ru/local/tools/ajax-vue.php"}}},created:function(){var t=this;this.axios.post(this.url.meters).then((function(e){t.meters=e.data})).catch((function(t){return console.log(t)}))},methods:{addRow:function(t){var e=this;this.axios.post(this.url.meters,t).then((function(t){e.meters=t.data}))},deleteRow:function(t){var e=this;if(!this.isAdmin)return alert("Удалять данные может только администратор!"),!1;var a=new FormData,r="delete_Admin";a.append("action",r),a.append("id",t),this.axios.post(this.url.meters,a).then((function(t){e.meters=t.data}))},editRow:function(t,e){var a=this;this.axios.post(this.url.meters,t).then((function(t){a.meters=t.data,a.meters[e].isUpdate="true",setTimeout((function(){a.$delete(a.meters[e],"isUpdate")}),3e3,e)}))}}},j=$,P=Object(d["a"])(j,p,f,!1,null,"6a4a645e",null),O=P.exports,E={name:"App",components:{Price:m,TableData:O},data:function(){return{price:{water:0,warming:0,electric:0},isAdmin:!1,textSearch:"",url:{price:"http://lobochkin.ru/local/tools/ajax-vue.php?price=1",isAdmin:"http://lobochkin.ru/local/tools/ajax-vue.php?action=isAdmin"}}},created:function(){var t=this;this.axios.get(this.url.price).then((function(e){t.price=e.data})).catch((function(t){return console.log(t)})),this.axios.get(this.url.isAdmin).then((function(e){t.isAdmin=e.data})).catch((function(t){return console.log(t)}))}},R=E,T=(a("204c"),a("b0a0"),Object(d["a"])(R,s,i,!1,null,"2d00d76b",null)),D=T.exports,q=a("d047"),N=a("5f5b"),S=a("b1e0"),U=a("bc3a"),B=a.n(U),F=a("a7fe"),I=a.n(F);a("faaa"),a("f9e3"),a("2dd8");r["default"].use(q["a"]),r["default"].use(I.a,B.a),r["default"].use(N["a"]),r["default"].use(S["a"]),r["default"].config.productionTip=!1,new r["default"]({render:function(t){return t(D)}}).$mount("#app")},b0a0:function(t,e,a){"use strict";var r=a("452c"),s=a.n(r);s.a},bd2b:function(t,e,a){},df99:function(t,e,a){"use strict";var r=a("314a"),s=a.n(r);s.a},faaa:function(t,e,a){}});
//# sourceMappingURL=app.js.map